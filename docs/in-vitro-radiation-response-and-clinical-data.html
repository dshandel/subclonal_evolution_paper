<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 In vitro radiation response and clinical data | Pre-existing Radioresistant Subclones Determine Radioresistance in Rectal Cancer Organoids</title>
  <meta name="description" content="2 In vitro radiation response and clinical data | Pre-existing Radioresistant Subclones Determine Radioresistance in Rectal Cancer Organoids" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="2 In vitro radiation response and clinical data | Pre-existing Radioresistant Subclones Determine Radioresistance in Rectal Cancer Organoids" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 In vitro radiation response and clinical data | Pre-existing Radioresistant Subclones Determine Radioresistance in Rectal Cancer Organoids" />
  
  
  

<meta name="author" content="Daan Andel" />


<meta name="date" content="2023-07-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="subclonal-dynamics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Subclonal Evolution Paper</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="in-vitro-radiation-response-and-clinical-data.html"><a href="in-vitro-radiation-response-and-clinical-data.html"><i class="fa fa-check"></i><b>2</b> In vitro radiation response and clinical data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="in-vitro-radiation-response-and-clinical-data.html"><a href="in-vitro-radiation-response-and-clinical-data.html#progression-free-survival"><i class="fa fa-check"></i><b>2.1</b> Progression-free survival</a></li>
<li class="chapter" data-level="2.2" data-path="in-vitro-radiation-response-and-clinical-data.html"><a href="in-vitro-radiation-response-and-clinical-data.html#in-vitro-dose-response"><i class="fa fa-check"></i><b>2.2</b> In vitro dose-response</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="in-vitro-radiation-response-and-clinical-data.html"><a href="in-vitro-radiation-response-and-clinical-data.html#dose-response-plot"><i class="fa fa-check"></i><b>2.2.1</b> Dose-response plot</a></li>
<li class="chapter" data-level="2.2.2" data-path="in-vitro-radiation-response-and-clinical-data.html"><a href="in-vitro-radiation-response-and-clinical-data.html#rauc-across-multiple-experiments"><i class="fa fa-check"></i><b>2.2.2</b> rAUC across multiple experiments</a></li>
<li class="chapter" data-level="2.2.3" data-path="in-vitro-radiation-response-and-clinical-data.html"><a href="in-vitro-radiation-response-and-clinical-data.html#flow-cytometry-based-measurement-of-apoptotic-cells-with-sub-g1-dna-content"><i class="fa fa-check"></i><b>2.2.3</b> Flow cytometry-based measurement of (apoptotic) cells with sub-G1 DNA content</a></li>
<li class="chapter" data-level="2.2.4" data-path="in-vitro-radiation-response-and-clinical-data.html"><a href="in-vitro-radiation-response-and-clinical-data.html#recovery-statistics-after-10-gy-radiation"><i class="fa fa-check"></i><b>2.2.4</b> Recovery statistics after 10 Gy radiation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="subclonal-dynamics.html"><a href="subclonal-dynamics.html"><i class="fa fa-check"></i><b>3</b> Subclonal dynamics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="subclonal-dynamics.html"><a href="subclonal-dynamics.html#aneufinder-run"><i class="fa fa-check"></i><b>3.1</b> AneuFinder run</a></li>
<li class="chapter" data-level="3.2" data-path="subclonal-dynamics.html"><a href="subclonal-dynamics.html#quality-selection"><i class="fa fa-check"></i><b>3.2</b> Quality selection</a></li>
<li class="chapter" data-level="3.3" data-path="subclonal-dynamics.html"><a href="subclonal-dynamics.html#summary-statistics-of-copy-number-alterations"><i class="fa fa-check"></i><b>3.3</b> Summary statistics of copy number alterations</a></li>
<li class="chapter" data-level="3.4" data-path="subclonal-dynamics.html"><a href="subclonal-dynamics.html#pca-and-k-means-plots"><i class="fa fa-check"></i><b>3.4</b> PCA and K-means plots</a></li>
<li class="chapter" data-level="3.5" data-path="subclonal-dynamics.html"><a href="subclonal-dynamics.html#subclone-selection"><i class="fa fa-check"></i><b>3.5</b> Subclone selection</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="subclonal-dynamics.html"><a href="subclonal-dynamics.html#selecting-subclones"><i class="fa fa-check"></i><b>3.5.1</b> Selecting subclones</a></li>
<li class="chapter" data-level="3.5.2" data-path="subclonal-dynamics.html"><a href="subclonal-dynamics.html#subclone-statistics"><i class="fa fa-check"></i><b>3.5.2</b> Subclone statistics</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="subclonal-dynamics.html"><a href="subclonal-dynamics.html#single-cell-copy-number-heatmap-plots"><i class="fa fa-check"></i><b>3.6</b> Single cell copy number heatmap plots</a></li>
<li class="chapter" data-level="3.7" data-path="subclonal-dynamics.html"><a href="subclonal-dynamics.html#fishers-test"><i class="fa fa-check"></i><b>3.7</b> Fishers test</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="copy-number-analyses.html"><a href="copy-number-analyses.html"><i class="fa fa-check"></i><b>4</b> Copy number analyses</a></li>
<li class="chapter" data-level="5" data-path="copy-number-pattern-analyses.html"><a href="copy-number-pattern-analyses.html"><i class="fa fa-check"></i><b>5</b> Copy number pattern analyses</a></li>
<li class="chapter" data-level="6" data-path="source-code.html"><a href="source-code.html"><i class="fa fa-check"></i><b>6</b> Source code</a>
<ul>
<li class="chapter" data-level="6.1" data-path="source-code.html"><a href="source-code.html#auc_rad-script-auc_fun-function"><i class="fa fa-check"></i><b>6.1</b> AUC_rad script: ‘AUC_fun’ function</a></li>
<li class="chapter" data-level="6.2" data-path="source-code.html"><a href="source-code.html#fitter_rad-script-fitter-function"><i class="fa fa-check"></i><b>6.2</b> fitter_rad script: ‘fitter’ function</a></li>
<li class="chapter" data-level="6.3" data-path="source-code.html"><a href="source-code.html#ic50_rad-script-ic50_fun-function"><i class="fa fa-check"></i><b>6.3</b> ic50_rad script: ‘IC50_fun’ function</a></li>
<li class="chapter" data-level="6.4" data-path="source-code.html"><a href="source-code.html#relativize_dr-script-relative-function"><i class="fa fa-check"></i><b>6.4</b> relativize_dr script: ‘relative’ function</a></li>
<li class="chapter" data-level="6.5" data-path="source-code.html"><a href="source-code.html#quality_functions-script-quality_check-quality_select-and-check_quality-functions"><i class="fa fa-check"></i><b>6.5</b> quality_functions script: ‘quality_check’, ‘quality_select’ and ‘check_quality’ functions</a></li>
<li class="chapter" data-level="6.6" data-path="source-code.html"><a href="source-code.html#plot_pca_kmeans-script-draw_pca-k_cluster-draw_pca_double-and-k_cluster_double-functions"><i class="fa fa-check"></i><b>6.6</b> plot_pca_kmeans script: ‘draw_pca’, ‘k_cluster’, ‘draw_pca_double’ and ‘k_cluster_double’ functions</a></li>
<li class="chapter" data-level="6.7" data-path="source-code.html"><a href="source-code.html#divide_subclone_functions-script-extract_other_cells-extract_square-l_g-and-subclone_classes_for_genomeheatmap-functions"><i class="fa fa-check"></i><b>6.7</b> divide_subclone_functions script: ‘extract_other_cells’, ‘extract_square’, ‘l_g’ and ‘subclone_classes_for_genomeheatmap’ functions</a></li>
<li class="chapter" data-level="6.8" data-path="source-code.html"><a href="source-code.html#plot_genomeheatmap-script-genomeheatmap-function"><i class="fa fa-check"></i><b>6.8</b> plot_genomeheatmap script: ‘genomeheatmap’ function</a></li>
<li class="chapter" data-level="6.9" data-path="source-code.html"><a href="source-code.html#fisher_test-script-perform_fisher-function"><i class="fa fa-check"></i><b>6.9</b> fisher_test script: ‘perform_fisher’ function</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pre-existing Radioresistant Subclones Determine Radioresistance in Rectal Cancer Organoids</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="in-vitro-radiation-response-and-clinical-data" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> In vitro radiation response and clinical data<a href="in-vitro-radiation-response-and-clinical-data.html#in-vitro-radiation-response-and-clinical-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="progression-free-survival" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Progression-free survival<a href="in-vitro-radiation-response-and-clinical-data.html#progression-free-survival" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb1-1" tabindex="-1"></a><span class="co"># Libraries and sources</span></span>
<span id="cb1-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb1-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb1-5" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb1-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb1-6" tabindex="-1"></a><span class="fu">library</span>(survival) </span>
<span id="cb1-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb1-7" tabindex="-1"></a><span class="fu">library</span>(survminer) </span>
<span id="cb1-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb1-8" tabindex="-1"></a><span class="fu">library</span>(survMisc)</span>
<span id="cb1-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb1-9" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-1" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb2-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-2" tabindex="-1"></a><span class="co"># Data #</span></span>
<span id="cb2-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-3" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb2-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-4" tabindex="-1"></a><span class="co"># Loading survival data from time of surgery</span></span>
<span id="cb2-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-5" tabindex="-1"></a>surg_surv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="st">&quot;../cna_analysis/data/clinical_and_dr/data_survival_progression.xlsx&quot;</span>, </span>
<span id="cb2-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-6" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">&quot;surg_surv&quot;</span>))</span>
<span id="cb2-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-8" tabindex="-1"></a><span class="co"># Loading progression data from time of surgery</span></span>
<span id="cb2-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-9" tabindex="-1"></a>surg_prog <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="st">&quot;../cna_analysis/data/clinical_and_dr/data_survival_progression.xlsx&quot;</span>, </span>
<span id="cb2-10"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-10" tabindex="-1"></a>                        <span class="at">sheet =</span> <span class="st">&quot;surg_prog&quot;</span>))</span>
<span id="cb2-11"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-12" tabindex="-1"></a><span class="do">#######</span></span>
<span id="cb2-13"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-13" tabindex="-1"></a><span class="co"># Run #</span></span>
<span id="cb2-14"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-14" tabindex="-1"></a><span class="do">#######</span></span>
<span id="cb2-15"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-15" tabindex="-1"></a><span class="do">## Survival from time of surgery ##</span></span>
<span id="cb2-16"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-16" tabindex="-1"></a>surg_surv_sum <span class="ot">&lt;-</span> <span class="fu">Surv</span>(<span class="at">time =</span> surg_surv<span class="sc">$</span>time, <span class="at">event =</span> surg_surv<span class="sc">$</span>status <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb2-17"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-18" tabindex="-1"></a><span class="co"># Fit without strata (~1)</span></span>
<span id="cb2-19"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-19" tabindex="-1"></a>surg_surv_fit <span class="ot">&lt;-</span> <span class="fu">survfit</span>(surg_surv_sum <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb2-20"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-21" tabindex="-1"></a><span class="co"># Median survival from time of surgery</span></span>
<span id="cb2-22"><a href="in-vitro-radiation-response-and-clinical-data.html#cb2-22" tabindex="-1"></a><span class="fu">surv_median</span>(surg_surv_fit)[<span class="dv">1</span>,<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 1857</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb4-1" tabindex="-1"></a><span class="do">## Progression from time of surgery ##</span></span>
<span id="cb4-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb4-2" tabindex="-1"></a>surg_prog_sum <span class="ot">&lt;-</span> <span class="fu">Surv</span>(<span class="at">time =</span> surg_prog<span class="sc">$</span>time, <span class="at">event =</span> surg_prog<span class="sc">$</span>status <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb4-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb4-4" tabindex="-1"></a><span class="co"># Fit without strata (~1)</span></span>
<span id="cb4-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb4-5" tabindex="-1"></a>surg_prog_fit <span class="ot">&lt;-</span> <span class="fu">survfit</span>(surg_prog_sum <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb4-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb4-7" tabindex="-1"></a><span class="co"># Median progression from time of surgery</span></span>
<span id="cb4-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb4-8" tabindex="-1"></a><span class="fu">surv_median</span>(surg_prog_fit)[<span class="dv">1</span>,<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-1" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb6-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-2" tabindex="-1"></a><span class="co"># Plot #</span></span>
<span id="cb6-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-3" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb6-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-5" tabindex="-1"></a><span class="co"># Constructing a dataframe for annotating labels</span></span>
<span id="cb6-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-6" tabindex="-1"></a>anno_df_prog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">label =</span> surg_prog<span class="sc">$</span>organoid, </span>
<span id="cb6-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-7" tabindex="-1"></a>                           <span class="at">time =</span> surg_prog<span class="sc">$</span>time)</span>
<span id="cb6-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-9" tabindex="-1"></a><span class="co"># make temp df with survival/prob data</span></span>
<span id="cb6-10"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-10" tabindex="-1"></a>temp_df_prob_prog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> surg_prog_fit<span class="sc">$</span>time,</span>
<span id="cb6-11"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-11" tabindex="-1"></a>                                <span class="at">prob =</span> surg_prog_fit<span class="sc">$</span>surv</span>
<span id="cb6-12"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-12" tabindex="-1"></a>                                )</span>
<span id="cb6-13"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-13" tabindex="-1"></a><span class="co"># join together</span></span>
<span id="cb6-14"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-14" tabindex="-1"></a>anno_df_prog <span class="ot">&lt;-</span> <span class="fu">left_join</span>(anno_df_prog, temp_df_prob_prog)</span>
<span id="cb6-15"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-15" tabindex="-1"></a></span>
<span id="cb6-16"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-16" tabindex="-1"></a><span class="co"># sort by time</span></span>
<span id="cb6-17"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-17" tabindex="-1"></a>anno_df_prog <span class="ot">&lt;-</span> anno_df_prog[<span class="fu">order</span>(anno_df_prog<span class="sc">$</span>time),]</span>
<span id="cb6-18"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-18" tabindex="-1"></a></span>
<span id="cb6-19"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-19" tabindex="-1"></a><span class="co"># Plotting progression free survival</span></span>
<span id="cb6-20"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-20" tabindex="-1"></a>prog_p <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(surg_prog_fit, <span class="at">data =</span> surg_prog, <span class="at">conf.int =</span> F, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#00887d&quot;</span>),</span>
<span id="cb6-21"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-21" tabindex="-1"></a>          <span class="at">ggtheme =</span> <span class="fu">theme_cowplot</span>(),</span>
<span id="cb6-22"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-22" tabindex="-1"></a>           <span class="at">legend =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb6-23"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-23" tabindex="-1"></a>           <span class="at">censor.size =</span> <span class="dv">8</span>,</span>
<span id="cb6-24"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-24" tabindex="-1"></a>           <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2200</span>),</span>
<span id="cb6-25"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-25" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&#39;Progression-free survival probability&#39;</span>, </span>
<span id="cb6-26"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-26" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&#39;Time from surgery (days)&#39;</span>)</span>
<span id="cb6-27"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-27" tabindex="-1"></a></span>
<span id="cb6-28"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-28" tabindex="-1"></a><span class="co"># adding labels</span></span>
<span id="cb6-29"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-29" tabindex="-1"></a>prog_p<span class="sc">$</span>plot <span class="ot">&lt;-</span> prog_p<span class="sc">$</span>plot <span class="sc">+</span> </span>
<span id="cb6-30"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-30" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, </span>
<span id="cb6-31"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-31" tabindex="-1"></a>                <span class="at">x =</span> anno_df_prog<span class="sc">$</span>time <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">350</span>, <span class="dv">350</span>, <span class="dv">350</span>, <span class="sc">-</span><span class="dv">150</span>,<span class="dv">50</span>,<span class="dv">250</span>,<span class="dv">0</span>,<span class="dv">0</span>), </span>
<span id="cb6-32"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-32" tabindex="-1"></a>           <span class="at">y =</span> anno_df_prog<span class="sc">$</span>prob <span class="sc">+</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>, <span class="sc">-</span><span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="sc">-</span><span class="fl">0.05</span>, <span class="fl">0.05</span>,<span class="sc">-</span><span class="fl">0.05</span>),</span>
<span id="cb6-33"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-33" tabindex="-1"></a>                <span class="at">label =</span> anno_df_prog<span class="sc">$</span>label) <span class="sc">+</span> </span>
<span id="cb6-34"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-34" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb6-35"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-35" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&#39;off&#39;</span>)</span>
<span id="cb6-36"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-36" tabindex="-1"></a></span>
<span id="cb6-37"><a href="in-vitro-radiation-response-and-clinical-data.html#cb6-37" tabindex="-1"></a>prog_p </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/plot%20Progression-free%20survival-1.png" width="672" /></p>
</div>
<div id="in-vitro-dose-response" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> In vitro dose-response<a href="in-vitro-radiation-response-and-clinical-data.html#in-vitro-dose-response" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-1" tabindex="-1"></a><span class="co"># Libraries and sources</span></span>
<span id="cb7-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># for wrangling data</span></span>
<span id="cb7-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-3" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co"># for reading excel files</span></span>
<span id="cb7-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-4" tabindex="-1"></a><span class="fu">library</span>(DescTools) <span class="co"># for computing AUCs with AUC() function)</span></span>
<span id="cb7-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-5" tabindex="-1"></a><span class="fu">library</span>(drc) <span class="co"># for fitting dose response </span></span>
<span id="cb7-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-6" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb7-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-7" tabindex="-1"></a><span class="fu">library</span>(wesanderson)</span>
<span id="cb7-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-8" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;R/auc_rad.R&#39;</span>)</span>
<span id="cb7-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-9" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;R/fitter_rad.R&#39;</span>)</span>
<span id="cb7-10"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-10" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;R/ic50_rad.R&#39;</span>)</span>
<span id="cb7-11"><a href="in-vitro-radiation-response-and-clinical-data.html#cb7-11" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;R/relativize_dr.R&#39;</span>)</span></code></pre></div>
<div id="dose-response-plot" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Dose-response plot<a href="in-vitro-radiation-response-and-clinical-data.html#dose-response-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-1" tabindex="-1"></a><span class="do">################</span></span>
<span id="cb8-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-2" tabindex="-1"></a><span class="co"># Loading data #</span></span>
<span id="cb8-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-3" tabindex="-1"></a><span class="do">################</span></span>
<span id="cb8-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-4" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">read_excel</span>(<span class="st">&#39;../cna_analysis/data/clinical_and_dr/resistancy_organoids.xlsx&#39;</span>))</span>
<span id="cb8-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-6" tabindex="-1"></a><span class="co"># remove fluke experiment (can&#39;t be fitted by the drc package in metricsandfits.R)</span></span>
<span id="cb8-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-7" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">subset</span>(d, expcode <span class="sc">!=</span> <span class="st">&#39;cva0028&#39;</span>)</span>
<span id="cb8-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-9" tabindex="-1"></a><span class="co"># remove dose 1, 10,12</span></span>
<span id="cb8-10"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-10" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">subset</span>(d, dose <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span>
<span id="cb8-11"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-12" tabindex="-1"></a><span class="co"># only include organoids that were not radiated</span></span>
<span id="cb8-13"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-13" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">subset</span>(d, rec_rad <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb8-14"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-15" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb8-16"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-16" tabindex="-1"></a><span class="co"># Relativize #</span></span>
<span id="cb8-17"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-17" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb8-18"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-18" tabindex="-1"></a><span class="co"># Relativizing the data</span></span>
<span id="cb8-19"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-19" tabindex="-1"></a></span>
<span id="cb8-20"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-20" tabindex="-1"></a><span class="co"># split per experiment</span></span>
<span id="cb8-21"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-21" tabindex="-1"></a>per_exp <span class="ot">&lt;-</span> <span class="fu">split</span>(d, <span class="at">f =</span> d<span class="sc">$</span>expcode, <span class="at">drop =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-22"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-22" tabindex="-1"></a></span>
<span id="cb8-23"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-23" tabindex="-1"></a><span class="co"># apply relative function to every instance in per_exp</span></span>
<span id="cb8-24"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-24" tabindex="-1"></a>rel_vector_unrad <span class="ot">&lt;-</span> <span class="fu">lapply</span>(per_exp, relative, <span class="at">rad =</span> F)</span>
<span id="cb8-25"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-25" tabindex="-1"></a></span>
<span id="cb8-26"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-26" tabindex="-1"></a><span class="co"># join the dataframes togheter</span></span>
<span id="cb8-27"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-27" tabindex="-1"></a>d_nonrad <span class="ot">=</span> <span class="fu">do.call</span>(rbind, rel_vector_unrad)</span>
<span id="cb8-28"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-28" tabindex="-1"></a></span>
<span id="cb8-29"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-29" tabindex="-1"></a><span class="co">#remove rownames</span></span>
<span id="cb8-30"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-30" tabindex="-1"></a><span class="fu">rownames</span>(d_nonrad) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb8-31"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-31" tabindex="-1"></a></span>
<span id="cb8-32"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-32" tabindex="-1"></a><span class="co"># pool d_rad and d_nonrad, if not possible, make d d_nonrad</span></span>
<span id="cb8-33"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-33" tabindex="-1"></a></span>
<span id="cb8-34"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-34" tabindex="-1"></a><span class="co"># try to bind d_rad and d_nonrad. If d_rad is empty (this is the case when</span></span>
<span id="cb8-35"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-35" tabindex="-1"></a><span class="co"># rec_rad does not have ones, make d the same as d_nonrad)</span></span>
<span id="cb8-36"><a href="in-vitro-radiation-response-and-clinical-data.html#cb8-36" tabindex="-1"></a>d <span class="ot">&lt;-</span> d_nonrad</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-1" tabindex="-1"></a><span class="do">################</span></span>
<span id="cb9-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-2" tabindex="-1"></a><span class="co"># Loading data #</span></span>
<span id="cb9-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-3" tabindex="-1"></a><span class="do">################</span></span>
<span id="cb9-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;../cna_analysis/rda/clinical_and_dr/wrangled-data.rda&quot;</span>) <span class="co"># load the wrangled data, data is saved under &#39;d&#39;</span></span>
<span id="cb9-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-6" tabindex="-1"></a><span class="co"># defining experiment number for reference</span></span>
<span id="cb9-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-7" tabindex="-1"></a>exp_numb <span class="ot">&lt;-</span> <span class="fu">unique</span>(d<span class="sc">$</span>expcode)</span>
<span id="cb9-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-8" tabindex="-1"></a>exp_numb <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">unlist</span>(exp_numb), <span class="at">collapse=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb9-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-10" tabindex="-1"></a><span class="do">##################</span></span>
<span id="cb9-11"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-11" tabindex="-1"></a><span class="do">### Metric AUC </span><span class="al">###</span></span>
<span id="cb9-12"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-12" tabindex="-1"></a><span class="do">##################</span></span>
<span id="cb9-13"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-13" tabindex="-1"></a><span class="co"># split per experiment</span></span>
<span id="cb9-14"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-14" tabindex="-1"></a>per_exp <span class="ot">&lt;-</span> <span class="fu">split</span>(d, <span class="at">f =</span> d<span class="sc">$</span>expcode, <span class="at">drop =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-15"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-15" tabindex="-1"></a><span class="co"># apply relative function to every instance in per_exp</span></span>
<span id="cb9-16"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-16" tabindex="-1"></a>AUC_vector <span class="ot">&lt;-</span> <span class="fu">lapply</span>(per_exp, AUC_fun)</span>
<span id="cb9-17"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-17" tabindex="-1"></a></span>
<span id="cb9-18"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-18" tabindex="-1"></a><span class="co"># join the dataframes togheter</span></span>
<span id="cb9-19"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-19" tabindex="-1"></a>AUC <span class="ot">=</span> <span class="fu">do.call</span>(rbind, AUC_vector)</span>
<span id="cb9-20"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-20" tabindex="-1"></a></span>
<span id="cb9-21"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-21" tabindex="-1"></a><span class="co"># remove rownames</span></span>
<span id="cb9-22"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-22" tabindex="-1"></a><span class="fu">rownames</span>(AUC) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb9-23"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-23" tabindex="-1"></a></span>
<span id="cb9-24"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-24" tabindex="-1"></a><span class="do">#######</span></span>
<span id="cb9-25"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-25" tabindex="-1"></a><span class="co"># Fit #</span></span>
<span id="cb9-26"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-26" tabindex="-1"></a><span class="do">#######</span></span>
<span id="cb9-27"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-27" tabindex="-1"></a><span class="co"># apply fit function to every instance in per_exp</span></span>
<span id="cb9-28"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-28" tabindex="-1"></a>fit_vector <span class="ot">&lt;-</span> <span class="fu">lapply</span>(per_exp, fitter)</span>
<span id="cb9-29"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-29" tabindex="-1"></a></span>
<span id="cb9-30"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-30" tabindex="-1"></a><span class="co"># join the dataframes toghether</span></span>
<span id="cb9-31"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-31" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">do.call</span>(rbind, fit_vector)</span>
<span id="cb9-32"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-32" tabindex="-1"></a></span>
<span id="cb9-33"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-33" tabindex="-1"></a><span class="co"># remove rownames</span></span>
<span id="cb9-34"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-34" tabindex="-1"></a><span class="fu">rownames</span>(fit) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb9-35"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-35" tabindex="-1"></a></span>
<span id="cb9-36"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-36" tabindex="-1"></a>fit<span class="sc">$</span>rec_rad <span class="ot">=</span> <span class="dv">0</span> </span>
<span id="cb9-37"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-37" tabindex="-1"></a></span>
<span id="cb9-38"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-38" tabindex="-1"></a><span class="co"># remove rownames</span></span>
<span id="cb9-39"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-39" tabindex="-1"></a><span class="fu">rownames</span>(fit) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb9-40"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-40" tabindex="-1"></a></span>
<span id="cb9-41"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-41" tabindex="-1"></a><span class="do">##################</span></span>
<span id="cb9-42"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-42" tabindex="-1"></a><span class="co"># relative IC50s #</span></span>
<span id="cb9-43"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-43" tabindex="-1"></a><span class="do">##################</span></span>
<span id="cb9-44"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-44" tabindex="-1"></a><span class="do">## relative under curve for unrad</span></span>
<span id="cb9-45"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-45" tabindex="-1"></a><span class="co"># apply relative function to every instance in per_exp</span></span>
<span id="cb9-46"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-46" tabindex="-1"></a>IC50_vector <span class="ot">&lt;-</span> <span class="fu">lapply</span>(per_exp, IC50_fun, <span class="at">rad =</span> <span class="dv">0</span>)</span>
<span id="cb9-47"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-47" tabindex="-1"></a></span>
<span id="cb9-48"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-48" tabindex="-1"></a><span class="co"># join the dataframes togheter</span></span>
<span id="cb9-49"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-49" tabindex="-1"></a>IC50<span class="ot">=</span> <span class="fu">do.call</span>(rbind, IC50_vector)</span>
<span id="cb9-50"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-50" tabindex="-1"></a></span>
<span id="cb9-51"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-51" tabindex="-1"></a>metrics <span class="ot">=</span> <span class="fu">cbind</span>(AUC, IC50)</span>
<span id="cb9-52"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-52" tabindex="-1"></a></span>
<span id="cb9-53"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-53" tabindex="-1"></a>metrics<span class="sc">$</span>rec_rad <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-54"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-54" tabindex="-1"></a></span>
<span id="cb9-55"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-55" tabindex="-1"></a><span class="co"># compute mean of rel_AUC</span></span>
<span id="cb9-56"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-56" tabindex="-1"></a>metrics_pooled <span class="ot">&lt;-</span> metrics <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cline) <span class="sc">%&gt;%</span> <span class="fu">summarise_at</span>(<span class="fu">vars</span>(rel_AUC),</span>
<span id="cb9-57"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-57" tabindex="-1"></a>                                                               <span class="fu">funs</span>(<span class="fu">mean</span>(., <span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb9-58"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-58" tabindex="-1"></a></span>
<span id="cb9-59"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-59" tabindex="-1"></a></span>
<span id="cb9-60"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-60" tabindex="-1"></a>metrics_pooled<span class="sc">$</span>expcode <span class="ot">&lt;-</span> exp_numb</span>
<span id="cb9-61"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-61" tabindex="-1"></a></span>
<span id="cb9-62"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-62" tabindex="-1"></a><span class="co"># compute mean of rel_AUC</span></span>
<span id="cb9-63"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-63" tabindex="-1"></a>metrics_pooled <span class="ot">&lt;-</span> metrics <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cline) <span class="sc">%&gt;%</span> <span class="fu">summarise_at</span>(<span class="fu">vars</span>(rel_AUC),</span>
<span id="cb9-64"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-64" tabindex="-1"></a>                                                               <span class="fu">funs</span>(<span class="fu">mean</span>(., <span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb9-65"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-65" tabindex="-1"></a></span>
<span id="cb9-66"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-66" tabindex="-1"></a></span>
<span id="cb9-67"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-67" tabindex="-1"></a><span class="co"># summary statistics</span></span>
<span id="cb9-68"><a href="in-vitro-radiation-response-and-clinical-data.html#cb9-68" tabindex="-1"></a><span class="fu">median</span>(metrics<span class="sc">$</span>rel_AUC)</span></code></pre></div>
<pre><code>## [1] 0.5758785</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb11-1" tabindex="-1"></a><span class="fu">min</span>(metrics<span class="sc">$</span>rel_AUC)</span></code></pre></div>
<pre><code>## [1] 0.304031</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb13-1" tabindex="-1"></a><span class="fu">max</span>(metrics<span class="sc">$</span>rel_AUC)</span></code></pre></div>
<pre><code>## [1] 0.8152938</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-1" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb15-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-2" tabindex="-1"></a><span class="co"># Data #</span></span>
<span id="cb15-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-3" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb15-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;../cna_analysis/rda/clinical_and_dr/wrangled-data.rda&quot;</span>) <span class="co"># load the wrangled data, data is saved under &#39;d&#39;</span></span>
<span id="cb15-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-5" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;../cna_analysis/rda/clinical_and_dr/fitted-data.rda&quot;</span>) <span class="co"># load the wrangled data, data is saved under &#39;fit&#39;</span></span>
<span id="cb15-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-6" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;../cna_analysis/rda/clinical_and_dr/metrics_data.rda&#39;</span>) <span class="co"># load the metrics data</span></span>
<span id="cb15-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-8" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb15-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-9" tabindex="-1"></a><span class="co"># Wrangle #</span></span>
<span id="cb15-10"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-10" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb15-11"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-11" tabindex="-1"></a><span class="do">### define two dataframes, one from rad one without rad:</span></span>
<span id="cb15-12"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-12" tabindex="-1"></a></span>
<span id="cb15-13"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-13" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">subset</span>(fit, rec_rad <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb15-14"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-15" tabindex="-1"></a>exp_numb <span class="ot">&lt;-</span> <span class="fu">unique</span>(d<span class="sc">$</span>expcode)</span>
<span id="cb15-16"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-16" tabindex="-1"></a>exp_numb <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">unlist</span>(exp_numb), <span class="at">collapse=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb15-17"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-17" tabindex="-1"></a></span>
<span id="cb15-18"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-18" tabindex="-1"></a><span class="co"># new data with doses. Note: lowest dose is not</span></span>
<span id="cb15-19"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-19" tabindex="-1"></a><span class="co"># log 0 but log(&#39;very small number&#39;) because otherwise this will hamper the scaling in ggplot later on.</span></span>
<span id="cb15-20"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-20" tabindex="-1"></a>d<span class="sc">$</span>dose0 <span class="ot">&lt;-</span> d<span class="sc">$</span>dose</span>
<span id="cb15-21"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-21" tabindex="-1"></a>d<span class="sc">$</span>dose0[d<span class="sc">$</span>dose0 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fl">0.00000001</span></span>
<span id="cb15-22"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-22" tabindex="-1"></a></span>
<span id="cb15-23"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-23" tabindex="-1"></a><span class="co"># representative expcodes</span></span>
<span id="cb15-24"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-24" tabindex="-1"></a><span class="co"># makeing helper column to extract representative expcodes</span></span>
<span id="cb15-25"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-25" tabindex="-1"></a>d<span class="sc">$</span>cline_expcode <span class="ot">&lt;-</span> <span class="fu">paste0</span>(d<span class="sc">$</span>cline, <span class="st">&#39;_&#39;</span>, d<span class="sc">$</span>expcode)</span>
<span id="cb15-26"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-26" tabindex="-1"></a>fit<span class="sc">$</span>cline_expcode <span class="ot">&lt;-</span> <span class="fu">paste0</span>(fit<span class="sc">$</span>cline, <span class="st">&#39;_&#39;</span>, fit<span class="sc">$</span>expcode)</span>
<span id="cb15-27"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-27" tabindex="-1"></a></span>
<span id="cb15-28"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-28" tabindex="-1"></a><span class="co"># subsetting</span></span>
<span id="cb15-29"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-29" tabindex="-1"></a>cline_expcode_pick <span class="ot">&lt;-</span></span>
<span id="cb15-30"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-30" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb15-31"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-31" tabindex="-1"></a>    <span class="st">&#39;HUB005_cva0025&#39;</span>,</span>
<span id="cb15-32"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-32" tabindex="-1"></a>    <span class="st">&#39;HUB183_cva0025&#39;</span>,</span>
<span id="cb15-33"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-33" tabindex="-1"></a>    <span class="st">&#39;HUB015_cva0023&#39;</span>,</span>
<span id="cb15-34"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-34" tabindex="-1"></a>    <span class="st">&#39;HUB175_cva0024&#39;</span>,</span>
<span id="cb15-35"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-35" tabindex="-1"></a>    <span class="st">&#39;HUB181I_cva0021&#39;</span>,</span>
<span id="cb15-36"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-36" tabindex="-1"></a>    <span class="st">&#39;HUB197_cva0030&#39;</span>,</span>
<span id="cb15-37"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-37" tabindex="-1"></a>    <span class="st">&#39;HUB106_cva0020&#39;</span>,</span>
<span id="cb15-38"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-38" tabindex="-1"></a>    <span class="st">&#39;HUB062_cva0023&#39;</span>,</span>
<span id="cb15-39"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-39" tabindex="-1"></a>    <span class="st">&#39;HUB112_cva0112&#39;</span>)</span>
<span id="cb15-40"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-40" tabindex="-1"></a>    </span>
<span id="cb15-41"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-41" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">subset</span>(d, cline_expcode <span class="sc">%in%</span> cline_expcode_pick)</span>
<span id="cb15-42"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-42" tabindex="-1"></a></span>
<span id="cb15-43"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-43" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">subset</span>(fit, cline_expcode <span class="sc">%in%</span> cline_expcode_pick)</span>
<span id="cb15-44"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-44" tabindex="-1"></a></span>
<span id="cb15-45"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-45" tabindex="-1"></a><span class="co"># add resistantcy group for colour coding</span></span>
<span id="cb15-46"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-46" tabindex="-1"></a>resistant <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;HUB005&#39;</span>, <span class="st">&#39;HUB183&#39;</span>, <span class="st">&#39;HUB015&#39;</span>)</span>
<span id="cb15-47"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-47" tabindex="-1"></a>sensitive <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;HUB197&#39;</span>, <span class="st">&#39;HUB106&#39;</span>, <span class="st">&#39;HUB062&#39;</span>)</span>
<span id="cb15-48"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-48" tabindex="-1"></a></span>
<span id="cb15-49"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-49" tabindex="-1"></a>d<span class="sc">$</span>resistancy_group <span class="ot">&lt;-</span></span>
<span id="cb15-50"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-50" tabindex="-1"></a>  <span class="fu">ifelse</span>(</span>
<span id="cb15-51"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-51" tabindex="-1"></a>    d<span class="sc">$</span>cline <span class="sc">%in%</span> resistant,</span>
<span id="cb15-52"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-52" tabindex="-1"></a>    <span class="st">&#39;Resistant&#39;</span>,</span>
<span id="cb15-53"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-53" tabindex="-1"></a>    <span class="fu">ifelse</span>(d<span class="sc">$</span>cline <span class="sc">%in%</span> sensitive, <span class="st">&#39;Sensitive&#39;</span>, <span class="st">&#39;Intermediate&#39;</span>)</span>
<span id="cb15-54"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-54" tabindex="-1"></a>  )</span>
<span id="cb15-55"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-55" tabindex="-1"></a></span>
<span id="cb15-56"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-56" tabindex="-1"></a>fit<span class="sc">$</span>resistancy_group <span class="ot">&lt;-</span></span>
<span id="cb15-57"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-57" tabindex="-1"></a>  <span class="fu">ifelse</span>(</span>
<span id="cb15-58"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-58" tabindex="-1"></a>    fit<span class="sc">$</span>cline <span class="sc">%in%</span> resistant,</span>
<span id="cb15-59"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-59" tabindex="-1"></a>    <span class="st">&#39;Resistant&#39;</span>,</span>
<span id="cb15-60"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-60" tabindex="-1"></a>    <span class="fu">ifelse</span>(fit<span class="sc">$</span>cline <span class="sc">%in%</span> sensitive, <span class="st">&#39;Sensitive&#39;</span>, <span class="st">&#39;Intermediate&#39;</span>)</span>
<span id="cb15-61"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-61" tabindex="-1"></a>  )</span>
<span id="cb15-62"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-62" tabindex="-1"></a></span>
<span id="cb15-63"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-63" tabindex="-1"></a><span class="co"># Make cline a factor and specify order by decreasing AUC mean</span></span>
<span id="cb15-64"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-64" tabindex="-1"></a>d<span class="sc">$</span>cline <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>cline, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;HUB005&#39;</span>, <span class="st">&#39;HUB183&#39;</span>, <span class="st">&#39;HUB015&#39;</span>, </span>
<span id="cb15-65"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-65" tabindex="-1"></a>                                      <span class="st">&#39;HUB112&#39;</span>, <span class="st">&#39;HUB175&#39;</span>, <span class="st">&#39;HUB181I&#39;</span>, </span>
<span id="cb15-66"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-66" tabindex="-1"></a>                                      <span class="st">&#39;HUB106&#39;</span>, <span class="st">&#39;HUB197&#39;</span>, <span class="st">&#39;HUB062&#39;</span>))</span>
<span id="cb15-67"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-67" tabindex="-1"></a></span>
<span id="cb15-68"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-68" tabindex="-1"></a>d<span class="sc">$</span>resistancy_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>resistancy_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;Resistant&#39;</span>, <span class="st">&#39;Intermediate&#39;</span>, <span class="st">&#39;Sensitive&#39;</span>))</span>
<span id="cb15-69"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-69" tabindex="-1"></a></span>
<span id="cb15-70"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-70" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> dose0, <span class="at">y =</span> relative_mean, <span class="at">group =</span> cline, <span class="at">col =</span> resistancy_group)) <span class="sc">+</span></span>
<span id="cb15-71"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-71" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span> d,</span>
<span id="cb15-72"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-72" tabindex="-1"></a>             <span class="at">size =</span><span class="dv">3</span>, <span class="fu">aes</span>(<span class="at">shape =</span> cline)) <span class="sc">+</span></span>
<span id="cb15-73"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-73" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> d,</span>
<span id="cb15-74"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-74" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">ymin=</span>relative_mean<span class="sc">-</span>relative_sem,<span class="at">ymax=</span>relative_mean<span class="sc">+</span>relative_sem),</span>
<span id="cb15-75"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-75" tabindex="-1"></a>                <span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb15-76"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-76" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> d) <span class="sc">+</span> </span>
<span id="cb15-77"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-77" tabindex="-1"></a>  <span class="co"># geom_line(data=fit, aes(x=dose, y=pred),</span></span>
<span id="cb15-78"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-78" tabindex="-1"></a>  <span class="co">#           size = 1) + </span></span>
<span id="cb15-79"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-79" tabindex="-1"></a>  <span class="co"># adding log x-axis</span></span>
<span id="cb15-80"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-80" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="co">#x=&quot;log10&quot;, </span></span>
<span id="cb15-81"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-81" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.00000001</span>, <span class="dv">8</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb15-82"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-82" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb15-83"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-83" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb15-84"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-84" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb15-85"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-85" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Normalized viability&#39;</span>) <span class="sc">+</span> </span>
<span id="cb15-86"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-86" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Dose (Gy)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb15-87"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-87" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-88"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-88" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-89"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-89" tabindex="-1"></a>    <span class="at">aspect.ratio =</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb15-90"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-90" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb15-91"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-91" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(</span>
<span id="cb15-92"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-92" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb15-93"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-93" tabindex="-1"></a>      <span class="at">Resistant =</span> <span class="st">&#39;#DE3163&#39;</span>,</span>
<span id="cb15-94"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-94" tabindex="-1"></a>      <span class="at">Sensitive =</span> <span class="st">&#39;#5090CD&#39;</span>,</span>
<span id="cb15-95"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-95" tabindex="-1"></a>      <span class="at">Intermediate =</span> <span class="st">&#39;grey75&#39;</span></span>
<span id="cb15-96"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-96" tabindex="-1"></a>    ),</span>
<span id="cb15-97"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-97" tabindex="-1"></a>    <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb15-98"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-98" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;blank&quot;</span>, <span class="fu">length</span>(</span>
<span id="cb15-99"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-99" tabindex="-1"></a>        <span class="fu">unique</span>(d<span class="sc">$</span>resistancy_group)</span>
<span id="cb15-100"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-100" tabindex="-1"></a>      ))),</span>
<span id="cb15-101"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-101" tabindex="-1"></a>      <span class="at">shape =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">19</span>, <span class="fu">length</span>(</span>
<span id="cb15-102"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-102" tabindex="-1"></a>        <span class="fu">unique</span>(d<span class="sc">$</span>resistancy_group)</span>
<span id="cb15-103"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-103" tabindex="-1"></a>      )))</span>
<span id="cb15-104"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-104" tabindex="-1"></a>    ))</span>
<span id="cb15-105"><a href="in-vitro-radiation-response-and-clinical-data.html#cb15-105" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/plots%20for%20in%20vitro%20dose-response-1.png" width="672" /></p>
</div>
<div id="rauc-across-multiple-experiments" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> rAUC across multiple experiments<a href="in-vitro-radiation-response-and-clinical-data.html#rauc-across-multiple-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-1" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb16-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-2" tabindex="-1"></a><span class="co"># Data #</span></span>
<span id="cb16-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-3" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb16-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;../cna_analysis/rda/clinical_and_dr/metrics_data.rda&#39;</span>) <span class="co"># load the wrangled data, data is saved under &#39;metrics&#39;</span></span>
<span id="cb16-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-6" tabindex="-1"></a>exp_numb <span class="ot">&lt;-</span> <span class="fu">unique</span>(metrics<span class="sc">$</span>expcode)</span>
<span id="cb16-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-7" tabindex="-1"></a>exp_numb <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">unlist</span>(exp_numb), <span class="at">collapse =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb16-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-9" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb16-10"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-10" tabindex="-1"></a><span class="co"># Wrangle #</span></span>
<span id="cb16-11"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-11" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb16-12"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-12" tabindex="-1"></a><span class="co"># Make cline a factor and specify order by decreasing AUC mean</span></span>
<span id="cb16-13"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-13" tabindex="-1"></a>metrics<span class="sc">$</span>cline <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb16-14"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-14" tabindex="-1"></a>  metrics<span class="sc">$</span>cline,</span>
<span id="cb16-15"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-15" tabindex="-1"></a>  <span class="at">levels =</span> metrics <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cline) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean_auc =</span> <span class="fu">mean</span>(rel_AUC)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>mean_auc) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(cline)</span>
<span id="cb16-16"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-16" tabindex="-1"></a>)</span>
<span id="cb16-17"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-17" tabindex="-1"></a></span>
<span id="cb16-18"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-18" tabindex="-1"></a><span class="co"># add resistantcy group for colour coding</span></span>
<span id="cb16-19"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-19" tabindex="-1"></a>resistant <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;HUB005&#39;</span>, <span class="st">&#39;HUB183&#39;</span>, <span class="st">&#39;HUB015&#39;</span>)</span>
<span id="cb16-20"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-20" tabindex="-1"></a>sensitive <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;HUB197&#39;</span>, <span class="st">&#39;HUB106&#39;</span>, <span class="st">&#39;HUB062&#39;</span>)</span>
<span id="cb16-21"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-21" tabindex="-1"></a></span>
<span id="cb16-22"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-22" tabindex="-1"></a>metrics<span class="sc">$</span>resistancy_group <span class="ot">&lt;-</span></span>
<span id="cb16-23"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-23" tabindex="-1"></a>  <span class="fu">ifelse</span>(</span>
<span id="cb16-24"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-24" tabindex="-1"></a>    metrics<span class="sc">$</span>cline <span class="sc">%in%</span> resistant,</span>
<span id="cb16-25"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-25" tabindex="-1"></a>    <span class="st">&#39;Resistant&#39;</span>,</span>
<span id="cb16-26"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-26" tabindex="-1"></a>    <span class="fu">ifelse</span>(metrics<span class="sc">$</span>cline <span class="sc">%in%</span> sensitive, <span class="st">&#39;Sensitive&#39;</span>, <span class="st">&#39;Intermediate&#39;</span>)</span>
<span id="cb16-27"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-27" tabindex="-1"></a>  )</span>
<span id="cb16-28"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-28" tabindex="-1"></a></span>
<span id="cb16-29"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-29" tabindex="-1"></a><span class="co"># changing order of resistancy_group</span></span>
<span id="cb16-30"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-30" tabindex="-1"></a>metrics<span class="sc">$</span>resistancy_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(metrics<span class="sc">$</span>resistancy_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Resistant&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;Sensitive&quot;</span>))</span>
<span id="cb16-31"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-31" tabindex="-1"></a></span>
<span id="cb16-32"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-32" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb16-33"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-33" tabindex="-1"></a><span class="co"># Plot #</span></span>
<span id="cb16-34"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-34" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb16-35"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-35" tabindex="-1"></a></span>
<span id="cb16-36"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-36" tabindex="-1"></a><span class="fu">ggplot</span>(metrics, <span class="fu">aes</span>(<span class="at">x =</span> cline, <span class="at">y =</span> rel_AUC, <span class="at">group =</span> cline)) <span class="sc">+</span></span>
<span id="cb16-37"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-37" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> resistancy_group)) <span class="sc">+</span></span>
<span id="cb16-38"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-38" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>,</span>
<span id="cb16-39"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-39" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.1</span>,</span>
<span id="cb16-40"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-40" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb16-41"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-41" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb16-42"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-42" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb16-43"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-43" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb16-44"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-44" tabindex="-1"></a>      <span class="at">Resistant =</span> <span class="st">&#39;#DE3163&#39;</span>,</span>
<span id="cb16-45"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-45" tabindex="-1"></a>      <span class="at">Sensitive =</span> <span class="st">&#39;#5090CD&#39;</span>,</span>
<span id="cb16-46"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-46" tabindex="-1"></a>      <span class="at">Intermediate =</span> <span class="st">&#39;grey75&#39;</span></span>
<span id="cb16-47"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-47" tabindex="-1"></a>    ),</span>
<span id="cb16-48"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-48" tabindex="-1"></a>    <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb16-49"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-49" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;blank&quot;</span>, <span class="fu">length</span>(</span>
<span id="cb16-50"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-50" tabindex="-1"></a>        <span class="fu">unique</span>(metrics<span class="sc">$</span>resistancy_group)</span>
<span id="cb16-51"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-51" tabindex="-1"></a>      ))),</span>
<span id="cb16-52"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-52" tabindex="-1"></a>      <span class="at">shape =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">19</span>, <span class="fu">length</span>(</span>
<span id="cb16-53"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-53" tabindex="-1"></a>        <span class="fu">unique</span>(metrics<span class="sc">$</span>resistancy_group)</span>
<span id="cb16-54"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-54" tabindex="-1"></a>      )))</span>
<span id="cb16-55"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-55" tabindex="-1"></a>    ))</span>
<span id="cb16-56"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-56" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-57"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-57" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;&#39;</span>) <span class="sc">+</span></span>
<span id="cb16-58"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-58" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Relative AUC&#39;</span>) <span class="sc">+</span></span>
<span id="cb16-59"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-59" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-60"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-60" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-61"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-61" tabindex="-1"></a>    <span class="at">aspect.ratio =</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">3</span>,</span>
<span id="cb16-62"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-62" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb16-63"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-63" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-64"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-64" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&#39;off&#39;</span>) <span class="sc">+</span> </span>
<span id="cb16-65"><a href="in-vitro-radiation-response-and-clinical-data.html#cb16-65" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/plot%20metrics%20plot%20in%20vitro%20dose-response-1.png" width="672" /></p>
</div>
<div id="flow-cytometry-based-measurement-of-apoptotic-cells-with-sub-g1-dna-content" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Flow cytometry-based measurement of (apoptotic) cells with sub-G1 DNA content<a href="in-vitro-radiation-response-and-clinical-data.html#flow-cytometry-based-measurement-of-apoptotic-cells-with-sub-g1-dna-content" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-1" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb17-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-2" tabindex="-1"></a><span class="co"># Wrangle #</span></span>
<span id="cb17-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-3" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb17-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-4" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb17-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-5" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">read_excel</span>(<span class="st">&quot;../cna_analysis/data/clinical_and_dr/nicoletti_data.xlsx&quot;</span>))</span>
<span id="cb17-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-7" tabindex="-1"></a><span class="co"># defining experiment number for referenc</span></span>
<span id="cb17-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-8" tabindex="-1"></a>exp_numb <span class="ot">&lt;-</span> <span class="fu">unique</span>(d<span class="sc">$</span>expcode)</span>
<span id="cb17-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-9" tabindex="-1"></a>exp_numb <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">unlist</span>(exp_numb), <span class="at">collapse =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb17-10"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-11" tabindex="-1"></a><span class="co"># defining apoptosis percentage</span></span>
<span id="cb17-12"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-12" tabindex="-1"></a>d<span class="sc">$</span>apop_perc <span class="ot">&lt;-</span> d<span class="sc">$</span>subg1 <span class="sc">/</span> d<span class="sc">$</span>singlets <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb17-13"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-13" tabindex="-1"></a></span>
<span id="cb17-14"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-14" tabindex="-1"></a>d_zero <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cline, expcode) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(cline, expcode) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dose <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb17-15"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-15" tabindex="-1"></a>d_five <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cline, expcode) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(cline, expcode) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dose <span class="sc">==</span> <span class="dv">5</span>)</span>
<span id="cb17-16"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-16" tabindex="-1"></a></span>
<span id="cb17-17"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-17" tabindex="-1"></a>df_fc_apop <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-18"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-18" tabindex="-1"></a>  <span class="at">cline =</span> d_zero<span class="sc">$</span>cline,</span>
<span id="cb17-19"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-19" tabindex="-1"></a>  <span class="at">expcode =</span> d_zero<span class="sc">$</span>expcode,</span>
<span id="cb17-20"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-20" tabindex="-1"></a>  <span class="at">fc_apop =</span> d_five<span class="sc">$</span>apop_perc <span class="sc">/</span> d_zero<span class="sc">$</span>apop_perc</span>
<span id="cb17-21"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-21" tabindex="-1"></a>) <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(cline) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean_apop_fc =</span> <span class="fu">mean</span>(fc_apop),</span>
<span id="cb17-22"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-22" tabindex="-1"></a>                                     <span class="at">sd_apop_fc =</span> <span class="fu">sd</span>(fc_apop))</span>
<span id="cb17-23"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-23" tabindex="-1"></a></span>
<span id="cb17-24"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-24" tabindex="-1"></a>df_fc_apop<span class="sc">$</span>cline <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_fc_apop<span class="sc">$</span>cline, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;HUB005&#39;</span>, <span class="st">&#39;HUB183&#39;</span>, <span class="st">&#39;HUB062&#39;</span>, <span class="st">&#39;HUB106&#39;</span>))</span>
<span id="cb17-25"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-25" tabindex="-1"></a></span>
<span id="cb17-26"><a href="in-vitro-radiation-response-and-clinical-data.html#cb17-26" tabindex="-1"></a>df_fc_apop</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   cline  mean_apop_fc sd_apop_fc
##   &lt;fct&gt;         &lt;dbl&gt;      &lt;dbl&gt;
## 1 HUB005         1.31     0.538 
## 2 HUB062         5.88     0.903 
## 3 HUB106        11.8      0.714 
## 4 HUB183         2.93     0.0548</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-1" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb19-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-2" tabindex="-1"></a><span class="co"># Plot #</span></span>
<span id="cb19-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-3" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb19-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-4" tabindex="-1"></a><span class="fu">ggplot</span>(df_fc_apop, <span class="fu">aes</span>(<span class="at">x=</span> cline, <span class="at">y =</span> mean_apop_fc, <span class="at">fill =</span> cline)) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">group =</span> cline), <span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>,</span>
<span id="cb19-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-6" tabindex="-1"></a>           <span class="at">position=</span><span class="fu">position_dodge</span>(),</span>
<span id="cb19-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-7" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb19-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-8" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean_apop_fc, <span class="at">ymax=</span>mean_apop_fc <span class="sc">+</span> sd_apop_fc),</span>
<span id="cb19-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-9" tabindex="-1"></a>                <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.65</span>), <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb19-10"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-10" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb19-11"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-11" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb19-12"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-12" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb19-13"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-13" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">HUB181I =</span> <span class="st">&quot;#8491B4FF&quot;</span>, </span>
<span id="cb19-14"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-14" tabindex="-1"></a>               <span class="at">HUB005 =</span> <span class="st">&quot;#E64B35FF&quot;</span>, </span>
<span id="cb19-15"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-15" tabindex="-1"></a>               <span class="at">HUB062 =</span> <span class="st">&quot;#91D1C2FF&quot;</span>, </span>
<span id="cb19-16"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-16" tabindex="-1"></a>               <span class="at">HUB015 =</span> <span class="st">&#39;#FADA5E&#39;</span>,</span>
<span id="cb19-17"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-17" tabindex="-1"></a>               <span class="at">HUB106 =</span> <span class="st">&quot;#3C5488FF&quot;</span>, </span>
<span id="cb19-18"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-18" tabindex="-1"></a>               <span class="at">HUB183 =</span> <span class="st">&quot;#F39B7FFF&quot;</span>, </span>
<span id="cb19-19"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-19" tabindex="-1"></a>               <span class="at">HUB175 =</span> <span class="st">&quot;#00A087FF&quot;</span>,</span>
<span id="cb19-20"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-20" tabindex="-1"></a>               <span class="at">HUB197 =</span> <span class="st">&#39;grey&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb19-21"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-21" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.01</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb19-22"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-22" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb19-23"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-23" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Fold change (% apoptotic cells)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb19-24"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-24" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;&#39;</span>) <span class="sc">+</span> </span>
<span id="cb19-25"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-25" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb19-26"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-26" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb19-27"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-27" tabindex="-1"></a>    <span class="at">aspect.ratio =</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">3</span>,</span>
<span id="cb19-28"><a href="in-vitro-radiation-response-and-clinical-data.html#cb19-28" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/wrangle%20and%20plot%20sub-G1-1.png" width="672" /></p>
</div>
<div id="recovery-statistics-after-10-gy-radiation" class="section level3 hasAnchor" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Recovery statistics after 10 Gy radiation<a href="in-vitro-radiation-response-and-clinical-data.html#recovery-statistics-after-10-gy-radiation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-1" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb20-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-2" tabindex="-1"></a><span class="co"># Data #</span></span>
<span id="cb20-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-3" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb20-4"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-4" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="st">&quot;../cna_analysis/data/clinical_and_dr/ 10gy_recovery_data.xlsx&quot;</span>))</span>
<span id="cb20-5"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-6" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb20-7"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-7" tabindex="-1"></a><span class="co"># Wrangle #</span></span>
<span id="cb20-8"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-8" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb20-9"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-9" tabindex="-1"></a>df_res <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, resistancy_group <span class="sc">==</span> <span class="st">&#39;Resistant&#39;</span>)</span>
<span id="cb20-10"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-10" tabindex="-1"></a>df_sens <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, resistancy_group <span class="sc">==</span> <span class="st">&#39;Sensitive&#39;</span>)</span>
<span id="cb20-11"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-11" tabindex="-1"></a></span>
<span id="cb20-12"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-12" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb20-13"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-13" tabindex="-1"></a><span class="co"># Statistics #</span></span>
<span id="cb20-14"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-14" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb20-15"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-15" tabindex="-1"></a><span class="co"># Resistant</span></span>
<span id="cb20-16"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-16" tabindex="-1"></a>mean_days_res <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(df_res<span class="sc">$</span>days_to_full_recovery), <span class="at">na.rm =</span> T)</span>
<span id="cb20-17"><a href="in-vitro-radiation-response-and-clinical-data.html#cb20-17" tabindex="-1"></a>mean_days_res</span></code></pre></div>
<pre><code>## [1] 30.66667</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb22-1" tabindex="-1"></a>sd_days_res <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(df_res<span class="sc">$</span>days_to_full_recovery), <span class="at">na.rm =</span> T)</span>
<span id="cb22-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb22-2" tabindex="-1"></a>sd_days_res</span></code></pre></div>
<pre><code>## [1] 11.54701</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb24-1" tabindex="-1"></a><span class="co"># Sensitive</span></span>
<span id="cb24-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb24-2" tabindex="-1"></a>mean_days_sens <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(df_sens<span class="sc">$</span>days_to_full_recovery), <span class="at">na.rm =</span> T)</span>
<span id="cb24-3"><a href="in-vitro-radiation-response-and-clinical-data.html#cb24-3" tabindex="-1"></a>mean_days_sens</span></code></pre></div>
<pre><code>## [1] 49</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="in-vitro-radiation-response-and-clinical-data.html#cb26-1" tabindex="-1"></a>sd_days_sens <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(df_sens<span class="sc">$</span>days_to_full_recovery), <span class="at">na.rm =</span> T)</span>
<span id="cb26-2"><a href="in-vitro-radiation-response-and-clinical-data.html#cb26-2" tabindex="-1"></a>sd_days_sens</span></code></pre></div>
<pre><code>## [1] 23.64318</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="subclonal-dynamics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dshandel/subclonal_evolution_paper/edit/main/02-radiation_response.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/dshandel/subclonal_evolution_paper/blob/main/02-radiation_response.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
